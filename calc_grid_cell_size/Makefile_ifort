HDF_ROOT=/sw/dataformats/hdf5/1.8.17/smp1/intel.16.0.3.210_threadsafe
HDF_LIB=$(HDF_ROOT)/lib
HDF_INC=$(HDF_ROOT)/include
NETCDF_ROOT=/sw/dataformats/netcdf/4.3.3.1/smp1/intel.16.0.3.210_threadsafe
NETCDF_LIB=$(NETCDF_ROOT)/lib
NETCDF_INC=$(NETCDF_ROOT)/include

FC=ifort
FCFLAGS=-O2 -I$(HDF_INC) -I$(NETCDF_INC) -Wl,-rpath,$(NETCDF_LIB) -Wl,-rpath,$(HDF_LIB)
LDFLAGS=-O2 -L$(HDF_LIB) -L$(NETCDF_LIB) -Wl,-rpath,$(NETCDF_LIB) -Wl,-rpath,$(HDF_LIB)
LIBS=-lnetcdff -lnetcdf -lhdf5_hl -lhdf5 -lz -lm
# not used
# -g debug
# -stand f03
# -qopenmp

## use
# module load intel.studio/16.0.3.210

all: calc_grid_cell_size.x
	echo "doing all"

calc_grid_cell_size.x: calc_grid_cell_size.o
	$(FC) calc_grid_cell_size.o -o calc_grid_cell_size.x $(LDFLAGS) $(LIBS)

calc_grid_cell_size.o: calc_grid_cell_size.f90
	$(FC) calc_grid_cell_size.f90 -c $(FCFLAGS) -o calc_grid_cell_size.o

wiOpenMP: calc_grid_cell_size.f90
	$(FC) calc_grid_cell_size.f90 -o calc_grid_cell_size_wiOpenMP.x -fopenmp $(FCFLAGS) $(LDFLAGS) $(LIBS)

noOpenMP: calc_grid_cell_size.f90
	$(FC) calc_grid_cell_size.f90 -o calc_grid_cell_size_noOpenMP.x $(FCFLAGS) $(LDFLAGS) $(LIBS)

clean:
	rm *.x *.o